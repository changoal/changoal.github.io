<!DOCTYPE html>
<html  lang="zh">
<head>
    <meta charset="utf-8">
<title>Scrapy 入门 - changoal</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />



    <meta name="description" content="scrapy 介绍scrapy 是一个基于 Python 语言的爬虫框架。有了框架的存在，我们可以更方便的爬虫了，框架帮我们封装好了下载等模块，而且更重要的是框架使用了异步的模式，加快了爬虫的速度。 环境搭建在命令行中执行 conda install Scrapy 这样就安装好了 Scrapy 模块，是不是特别简单。ahahahha 开始接下来就要开始我们的 scrapy 之路了。 新建项目使用">
<meta name="keywords" content="Python,爬虫">
<meta property="og:type" content="article">
<meta property="og:title" content="Scrapy 入门">
<meta property="og:url" content="http://yoursite.com/2017/09/02/Scrapy-入门/index.html">
<meta property="og:site_name" content="changoal">
<meta property="og:description" content="scrapy 介绍scrapy 是一个基于 Python 语言的爬虫框架。有了框架的存在，我们可以更方便的爬虫了，框架帮我们封装好了下载等模块，而且更重要的是框架使用了异步的模式，加快了爬虫的速度。 环境搭建在命令行中执行 conda install Scrapy 这样就安装好了 Scrapy 模块，是不是特别简单。ahahahha 开始接下来就要开始我们的 scrapy 之路了。 新建项目使用">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/11/%E5%BF%AB%E6%8D%B7%E5%90%AF%E5%8A%A8.png">
<meta property="og:image" content="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/12/scrapy_architecture.png">
<meta property="og:image" content="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/11/%E5%88%86%E6%9E%90%E7%BD%91%E9%A1%B52.png">
<meta property="og:image" content="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/12/Scrapy12.png">
<meta property="og:image" content="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/12/setting02.png">
<meta property="og:image" content="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/12/Scrapy13.png">
<meta property="og:image" content="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/12/Scrapy14.png">
<meta property="og:image" content="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/12/scrapy21.png">
<meta property="og:image" content="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/12/Scrapy16.png">
<meta property="og:updated_time" content="2017-09-02T13:20:10.274Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Scrapy 入门">
<meta name="twitter:description" content="scrapy 介绍scrapy 是一个基于 Python 语言的爬虫框架。有了框架的存在，我们可以更方便的爬虫了，框架帮我们封装好了下载等模块，而且更重要的是框架使用了异步的模式，加快了爬虫的速度。 环境搭建在命令行中执行 conda install Scrapy 这样就安装好了 Scrapy 模块，是不是特别简单。ahahahha 开始接下来就要开始我们的 scrapy 之路了。 新建项目使用">
<meta name="twitter:image" content="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/11/%E5%BF%AB%E6%8D%B7%E5%90%AF%E5%8A%A8.png">





<link rel="icon" href="/images/icon_round.png">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css">
<link rel="stylesheet" href="/css/style.css">


    
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">
    

    
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">
    

    
    
    
    <style>body{opacity: 0}</style>
    

    
    
    
    


    
    
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-105599788-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-105599788-1');
</script>


    
    
    
    

    


</head>
<body class="is-3-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/icon_round.png" alt="" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item"
                href="/">Home</a>
                
                <a class="navbar-item"
                href="/archives">Archives</a>
                
                <a class="navbar-item"
                href="/categories">Categories</a>
                
                <a class="navbar-item"
                href="/tags">Tags</a>
                
                <a class="navbar-item"
                href="/about">About</a>
                
            </div>
            
            <div class="navbar-end">
                
                
                <a class="navbar-item search" title="搜索" href="javascript:;">
                    <i class="material-icons is-size-5">search</i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns main">
                <div class="column is-8-tablet is-8-desktop is-6-widescreen has-order-2"><div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-09-02T13:19:00.000Z">2017-09-02</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/Python/">Python</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/Python/爬虫/">爬虫</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    24 分钟 读完 (大约 3561 个字)
                </span>
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                Scrapy 入门
            
        </h1>
        <div class="content">
            <h1 id="scrapy-介绍"><a href="#scrapy-介绍" class="headerlink" title="scrapy 介绍"></a>scrapy 介绍</h1><p>scrapy 是一个基于 Python 语言的爬虫框架。有了框架的存在，我们可以更方便的爬虫了，框架帮我们封装好了下载等模块，而且更重要的是框架使用了异步的模式，加快了爬虫的速度。</p>
<h1 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h1><p>在命令行中执行 <code>conda install Scrapy</code> 这样就安装好了 Scrapy 模块，是不是特别简单。ahahahha</p>
<h1 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h1><p>接下来就要开始我们的 scrapy 之路了。</p>
<h2 id="新建项目"><a href="#新建项目" class="headerlink" title="新建项目"></a>新建项目</h2><p>使用 Scrapy 第一步：创建项目，命令行进入你需要放置项目的目录，然后执行</p>
<p> <code>scrapy startproject ScrapyDemo   #ScrapyDemo是项目名称</code> </p>
<h2 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h2><p>这时会在目录下多出一个 ScrapyDemo 文件夹，这就是 Scrapy 项目了，项目的结构如下<br><figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">|-- ScrapyDemo</span><br><span class="line">|   `-- ScrapyDemo</span><br><span class="line">|       |-- spiders</span><br><span class="line">|       |   `-- __init__.py</span><br><span class="line">|       |-- __init__.py</span><br><span class="line">|       |-- items.py</span><br><span class="line">|       |-- middlewares.py</span><br><span class="line">|       |-- pipelines.py</span><br><span class="line">|       `-- settings.py</span><br><span class="line">`-- scrapy.cfg</span><br></pre></td></tr></table></figure></p>
<p>目录说明：</p>
<ul>
<li>ScrapyDemo(外层) 项目总目录</li>
<li>ScrapyDemo(内层) 项目目录</li>
<li>scrapy.cfg 项目的配置文件</li>
<li>spiders 放置我们的爬虫代码的目录</li>
<li>items.py 定义我们需要获取的字段</li>
<li>middlewares.py </li>
<li>pipelines.py 用来定义存储</li>
<li>settings.py 项目设置文件</li>
</ul>
<p>还有一点要注意的是，Scrapy 默认是不能在 IDE 中调试的，所以要在项目总目录下新建一个 entrypoint.py 文件，写下以下内容：<br><figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">from</span> scrapy.cmdline <span class="hljs-keyword">import</span> execute</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># 前两个参数是不变的，第三个参数是自己定义的 spider 的名字</span></span><br><span class="line">execute([<span class="hljs-string">'scrapy'</span>, <span class="hljs-string">'crawl'</span>, <span class="hljs-string">'dingdian'</span>])</span><br></pre></td></tr></table></figure></p>
<p>现在整个目录应该是这样（盗图..）</p>
<p><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/11/%E5%BF%AB%E6%8D%B7%E5%90%AF%E5%8A%A8.png" alt=""></p>
<h2 id="架构"><a href="#架构" class="headerlink" title="架构"></a>架构</h2><p>下面我们先来看一下框架的架构图</p>
<p><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/12/scrapy_architecture.png" alt=""></p>
<blockquote>
<p>Scrapy Engine: 这是引擎，负责Spiders、ItemPipeline、Downloader、Scheduler中间的通讯，信号、数据传递等等！（像不像人的身体？）</p>
<p>Scheduler(调度器): 它负责接受引擎发送过来的requests请求，并按照一定的方式进行整理排列，入队、并等待Scrapy Engine(引擎)来请求时，交给引擎。</p>
<p>Downloader（下载器）：负责下载Scrapy Engine(引擎)发送的所有Requests请求，并将其获取到的Responses交还给Scrapy Engine(引擎)，由引擎交给Spiders来处理，</p>
<p>Spiders：它负责处理所有Responses,从中分析提取数据，获取Item字段需要的数据，并将需要跟进的URL提交给引擎，再次进入Scheduler(调度器)，</p>
<p>Item Pipeline：它负责处理Spiders中获取到的Item，并进行处理，比如去重，持久化存储（存数据库，写入文件，总之就是保存数据用的）</p>
<p>Downloader Middlewares（下载中间件）：你可以当作是一个可以自定义扩展下载功能的组件</p>
<p>Spider Middlewares（Spider中间件）：你可以理解为是一个可以自定扩展和操作引擎和Spiders中间‘通信’的功能组件（比如进入Spiders的Responses;和从Spiders出去的Requests）</p>
</blockquote>
<p>数据在整个Scrapy的流向：</p>
<blockquote>
<p>程序运行的时候，</p>
<p>引擎：Hi！Spider, 你要处理哪一个网站？</p>
<p>Spiders：我要处理23wx.com</p>
<p>引擎：你把第一个需要的处理的URL给我吧。</p>
<p>Spiders：给你第一个URL是XXXXXXX.com</p>
<p>引擎：Hi！调度器，我这有request你帮我排序入队一下。</p>
<p>调度器：好的，正在处理你等一下。</p>
<p>引擎：Hi！调度器，把你处理好的request给我，</p>
<p>调度器：给你，这是我处理好的request</p>
<p>引擎：Hi！下载器，你按照下载中间件的设置帮我下载一下这个request</p>
<p>下载器：好的！给你，这是下载好的东西。（如果失败：不好意思，这个request下载失败，然后引擎告诉调度器，这个request下载失败了，你记录一下，我们待会儿再下载。）</p>
<p>引擎：Hi！Spiders，这是下载好的东西，并且已经按照Spider中间件处理过了，你处理一下（注意！这儿responses默认是交给def parse这个函数处理的）</p>
<p>Spiders：（处理完毕数据之后对于需要跟进的URL），Hi！引擎，这是我需要跟进的URL，将它的responses交给函数 def  xxxx(self, responses)处理。还有这是我获取到的Item。</p>
<p>引擎：Hi ！Item Pipeline 我这儿有个item你帮我处理一下！调度器！这是我需要的URL你帮我处理下。然后从第四步开始循环，直到获取到你需要的信息，</p>
<p>注意！只有当调度器中不存在任何request了，整个程序才会停止，（也就是说，对于下载失败的 URL，Scrapy会重新下载。）</p>
</blockquote>
<h2 id="写代码"><a href="#写代码" class="headerlink" title="写代码"></a>写代码</h2><p>建立一个项目之后：</p>
<p>第一件事就是在 items.py 文件中定义我们需要的字段，用来临时存储要保存的数据，方便以后数据的持久化存储，比如 数据库 文本文件等。</p>
<p>第二件事是在 spiders.py 中编写自己的爬虫代码</p>
<p>第三件事是在 pipelines.py 中存储自己的数据</p>
<p><strong>建议：在大家调试的时候在settings.py中取消下面几行的注释：</strong><br><figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">HTTPCACHE_ENABLED = <span class="hljs-keyword">True</span></span><br><span class="line">HTTPCACHE_EXPIRATION_SECS = <span class="hljs-number">0</span></span><br><span class="line">HTTPCACHE_DIR = <span class="hljs-string">'httpcache'</span></span><br><span class="line">HTTPCACHE_IGNORE_HTTP_CODES = []</span><br><span class="line">HTTPCACHE_STORAGE = <span class="hljs-string">'scrapy.extensions.httpcache.FilesystemCacheStorage'</span></span><br></pre></td></tr></table></figure></p>
<p>上面代码的作用是 Scrapy 会缓存你有的 Requests！ 当你再次请求时，如果存在缓存文档则返回缓存文档，而不是去网站请求，这样既加快了本地调试速度，也减轻了 网站的压力。一举多得</p>
<h3 id="定义字段"><a href="#定义字段" class="headerlink" title="定义字段"></a>定义字段</h3><p>要根据自己要爬取的内容来定义字段。比如，在这里我们要爬的是小说站点就需要定义，小说名字，作者，小说地址，连载状态，字数，文章类别 等字段。</p>
<p>就像下面这样：<br><figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ScrapydemoItem</span><span class="hljs-params">(scrapy.Item)</span>:</span></span><br><span class="line">    <span class="hljs-comment"># 小说名字</span></span><br><span class="line">    name = scrapy.Field()</span><br><span class="line">    <span class="hljs-comment"># 作者</span></span><br><span class="line">    author = scrapy.Field()</span><br><span class="line">    <span class="hljs-comment"># 小说地址</span></span><br><span class="line">    novelurl = scrapy.Field()</span><br><span class="line">    <span class="hljs-comment"># 连载状态</span></span><br><span class="line">    serialstatus = scrapy.Field()</span><br><span class="line">    <span class="hljs-comment"># 连载字数</span></span><br><span class="line">    serialnumber = scrapy.Field()</span><br><span class="line">    <span class="hljs-comment"># 类别</span></span><br><span class="line">    category = scrapy.Field()</span><br><span class="line">    <span class="hljs-comment"># 编号</span></span><br><span class="line">    novel_id = scrapy.Field()</span><br></pre></td></tr></table></figure></p>
<h3 id="编写-spider"><a href="#编写-spider" class="headerlink" title="编写 spider"></a>编写 spider</h3><p>在 spiders 目录下新建一个 ScrapyDemo.py 文件，并导入我们需用的模块</p>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> scrapy </span><br><span class="line"><span class="hljs-keyword">import</span> re</span><br><span class="line"><span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="hljs-keyword">from</span> scrapy.http <span class="hljs-keyword">import</span> Request</span><br><span class="line"><span class="hljs-keyword">from</span> ScrapyDemo.items <span class="hljs-keyword">import</span> ScrapydemoItem</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Muspider</span><span class="hljs-params">(scrapy.Spider)</span>:</span></span><br></pre></td></tr></table></figure>
<p>我们需要从一个地址入手开始爬取，我在顶点小说上没有发现有全站小说地址，但是我找到每个分类地址全部小说：</p>
<p>玄幻魔幻：<a href="http://www.x23us.com/class/1_1.html" target="_blank" rel="noopener">http://www.x23us.com/class/1_1.html</a></p>
<p>武侠修真：<a href="http://www.x23us.com/class/2_1.html" target="_blank" rel="noopener">http://www.x23us.com/class/2_1.html</a></p>
<p>都市言情：<a href="http://www.x23us.com/class/3_1.html" target="_blank" rel="noopener">http://www.x23us.com/class/3_1.html</a></p>
<p>历史军事：<a href="http://www.x23us.com/class/4_1.html" target="_blank" rel="noopener">http://www.x23us.com/class/4_1.html</a></p>
<p>侦探推理：<a href="http://www.x23us.com/class/5_1.html" target="_blank" rel="noopener">http://www.x23us.com/class/5_1.html</a></p>
<p>网游动漫：<a href="http://www.x23us.com/class/6_1.html" target="_blank" rel="noopener">http://www.x23us.com/class/6_1.html</a></p>
<p>科幻小说：<a href="http://www.x23us.com/class/7_1.html" target="_blank" rel="noopener">http://www.x23us.com/class/7_1.html</a></p>
<p>恐怖灵异：<a href="http://www.x23us.com/class/8_1.html" target="_blank" rel="noopener">http://www.x23us.com/class/8_1.html</a></p>
<p>散文诗词：<a href="http://www.x23us.com/class/9_1.html" target="_blank" rel="noopener">http://www.x23us.com/class/9_1.html</a></p>
<p>其他：<a href="http://www.x23us.com/class/10_1.html" target="_blank" rel="noopener">http://www.x23us.com/class/10_1.html</a></p>
<p>全本：<a href="http://www.x23us.com/quanben/1" target="_blank" rel="noopener">http://www.x23us.com/quanben/1</a></p>
<p>好啦！入口地址我们找到了，现在开始写第一部分代码：</p>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> scrapy</span><br><span class="line"><span class="hljs-keyword">import</span> re</span><br><span class="line"><span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="hljs-keyword">from</span> scrapy.http <span class="hljs-keyword">import</span> Request</span><br><span class="line"><span class="hljs-keyword">from</span> ScrapyDemo.items <span class="hljs-keyword">import</span> ScrapydemoItem</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Myspider</span><span class="hljs-params">(scrapy.Spider)</span>:</span></span><br><span class="line">    name = <span class="hljs-string">'ScrapyDemo'</span></span><br><span class="line">    allowed_domains = [<span class="hljs-string">'x23us.com'</span>]</span><br><span class="line">    bash_url = <span class="hljs-string">'http://www.x23us.com/class/'</span></span><br><span class="line">    bashurl = <span class="hljs-string">'.html'</span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">start_requests</span><span class="hljs-params">(self)</span>:</span></span><br><span class="line">        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">1</span>, <span class="hljs-number">11</span>):</span><br><span class="line">            url = self.bash_url + str(i) + <span class="hljs-string">'_1'</span> + self.bashurl</span><br><span class="line">            <span class="hljs-keyword">yield</span> Request(url,self.parse)</span><br><span class="line"></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">parse</span><span class="hljs-params">(self, response)</span>:</span></span><br><span class="line">        print(response.text)</span><br></pre></td></tr></table></figure>
<p>首先我们创建一个类 Myspider；这个类继承自 scrapy.Spider</p>
<p>定义了一个 allowed_domains ；这个不是必须的；但是在某写情况下需要用得到，比如使用爬取规则的时候就需要了；它的作用是只会跟进存在于 allowed_domains 中的 URL。不存在的 URL 会被忽略。</p>
<p><strong>第九行定义的 name 是之前我们在 entrypoint.py 文件中的第三个参数 此 name 在整个项目中有且只能有一个、名字不可重复！！！</strong></p>
<p>之后可以运行 entrypoint.py 文件来检查一下代码时候可以正常工作。</p>
<p>请求就这么轻而易举的实现了啊！简直So Easy！</p>
<p>继续 继续！</p>
<p>我们需要历遍所有页面才能取得所有的小说页面连接：</p>
<p><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/11/%E5%88%86%E6%9E%90%E7%BD%91%E9%A1%B52.png" alt=""></p>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> scrapy</span><br><span class="line"><span class="hljs-keyword">import</span> re</span><br><span class="line"><span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="hljs-keyword">from</span> scrapy.http <span class="hljs-keyword">import</span> Request</span><br><span class="line"><span class="hljs-keyword">from</span> ScrapyDemo.items <span class="hljs-keyword">import</span> ScrapydemoItem</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Muspider</span><span class="hljs-params">(scrapy.Spider)</span>:</span></span><br><span class="line">    name = <span class="hljs-string">'ScrapyDemo'</span></span><br><span class="line">    allowed_domains = [<span class="hljs-string">'x23us.com'</span>]</span><br><span class="line">    bash_url = <span class="hljs-string">'http://www.x23us.com/class/'</span></span><br><span class="line">    bashurl = <span class="hljs-string">'.html'</span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">start_requests</span><span class="hljs-params">(self)</span>:</span></span><br><span class="line">        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">1</span>, <span class="hljs-number">11</span>):</span><br><span class="line">            url = self.bash_url + str(i) + <span class="hljs-string">'_1'</span> + self.bashurl</span><br><span class="line">            <span class="hljs-keyword">yield</span> Request(url, self.parse)</span><br><span class="line"></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">parse</span><span class="hljs-params">(self, response)</span>:</span></span><br><span class="line">        max_span = BeautifulSoup(response.text, <span class="hljs-string">'lxml'</span>).find(<span class="hljs-string">'div'</span>, class_=<span class="hljs-string">'pagelink'</span>).find_all(<span class="hljs-string">'a'</span>)[<span class="hljs-number">-1</span>].get_text()</span><br><span class="line">        bashurl = str(response.url)[:<span class="hljs-number">-6</span>]</span><br><span class="line">        <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> range(<span class="hljs-number">1</span>, int(max_span) + <span class="hljs-number">1</span>):</span><br><span class="line">            url = bashurl + str(num) + self.bashurl</span><br><span class="line">            <span class="hljs-keyword">yield</span> Request(url, self.get_name)</span><br><span class="line"></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_name</span><span class="hljs-params">(self, response)</span>:</span></span><br><span class="line">        novels = BeautifulSoup(str(response), <span class="hljs-string">'lxml'</span>).find_all(<span class="hljs-string">'tr'</span>, bgcolor=<span class="hljs-string">'#F2F2F2'</span>)</span><br><span class="line">        <span class="hljs-keyword">for</span> navel <span class="hljs-keyword">in</span> novels:</span><br><span class="line">            a = navel.find(<span class="hljs-string">'a'</span>)</span><br><span class="line">            name = a[<span class="hljs-string">'title'</span>]</span><br><span class="line">            url = a[<span class="hljs-string">'href'</span>]</span><br><span class="line">            <span class="hljs-keyword">yield</span> Request(url, callback=self.get_chapterurl, meta=&#123;<span class="hljs-string">'name'</span>: name, <span class="hljs-string">'url'</span>: url&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_chapterurl</span><span class="hljs-params">(self, response)</span>:</span></span><br><span class="line">        item = ScrapydemoItem()</span><br><span class="line">        item[<span class="hljs-string">'name'</span>] = str(response.meta[<span class="hljs-string">'name'</span>]).replace(<span class="hljs-string">'\xa0'</span>, <span class="hljs-string">''</span>)</span><br><span class="line">        item[<span class="hljs-string">'novelurl'</span>] = response.meta[<span class="hljs-string">'url'</span>]</span><br><span class="line">        category = BeautifulSoup(response.text, <span class="hljs-string">'lxml'</span>).find(<span class="hljs-string">'table'</span>).find(<span class="hljs-string">'a'</span>).get_text()</span><br><span class="line">        author = BeautifulSoup(response.text, <span class="hljs-string">'lxml'</span>).find(<span class="hljs-string">'table'</span>).find_all(<span class="hljs-string">'td'</span>)[<span class="hljs-number">1</span>].get_text()</span><br><span class="line">        bash_url = BeautifulSoup(response.text, <span class="hljs-string">'lxml'</span>).find(<span class="hljs-string">'p'</span>, class_=<span class="hljs-string">'btnlinks'</span>).find(<span class="hljs-string">'a'</span>, class_=<span class="hljs-string">'read'</span>)[<span class="hljs-string">'href'</span>]</span><br><span class="line">        name_id = str(bash_url)[<span class="hljs-number">-6</span>:<span class="hljs-number">-1</span>].replace(<span class="hljs-string">'/'</span>, <span class="hljs-string">''</span>)</span><br><span class="line">        item[<span class="hljs-string">'category'</span>] = str(category).replace(<span class="hljs-string">'/'</span>, <span class="hljs-string">''</span>)</span><br><span class="line">        item[<span class="hljs-string">'author'</span>] = str(author).replace(<span class="hljs-string">'/'</span>, <span class="hljs-string">''</span>)</span><br><span class="line">        item[<span class="hljs-string">'name_id'</span>] = name_id</span><br><span class="line">        <span class="hljs-keyword">return</span> item</span><br></pre></td></tr></table></figure>
<h3 id="自定义-Pipeline"><a href="#自定义-Pipeline" class="headerlink" title="自定义 Pipeline"></a>自定义 Pipeline</h3><p>做一个自定义的MySQL的Pipeline。首先为了能好区分框架自带的Pipeline，我们把MySQL的Pipeline单独放到一个目录里面。</p>
<p><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/12/Scrapy12.png" alt=""></p>
<p>pipelines.py  这个是我们写存放数据的文件</p>
<p>sql.py 看名字就知道，需要的sql语句。</p>
<p>首先是需要的 MySQL 表,<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">IF</span> <span class="hljs-keyword">EXISTS</span> <span class="hljs-string">`dd_name`</span>;</span><br><span class="line"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-string">`dd_name`</span> (</span><br><span class="line">  <span class="hljs-string">`id`</span> <span class="hljs-built_in">int</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="hljs-string">`xs_name`</span> <span class="hljs-built_in">varchar</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">  <span class="hljs-string">`xs_author`</span> <span class="hljs-built_in">varchar</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">  <span class="hljs-string">`category`</span> <span class="hljs-built_in">varchar</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">  <span class="hljs-string">`name_id`</span> <span class="hljs-built_in">varchar</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="hljs-keyword">KEY</span> (<span class="hljs-string">`id`</span>)</span><br><span class="line">) <span class="hljs-keyword">ENGINE</span>=<span class="hljs-keyword">InnoDB</span> AUTO_INCREMENT=<span class="hljs-number">38</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">CHARSET</span>=utf8mb4;</span><br></pre></td></tr></table></figure></p>
<p>记得在 settings.py 文件中定义好 MySQL 的配置文件<br><figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">MYSQL_HOSTS = <span class="hljs-string">'127.0.0.1'</span></span><br><span class="line">MYSQL_USER = <span class="hljs-string">'root'</span></span><br><span class="line">MYSQL_PORT = <span class="hljs-string">'3306'</span></span><br><span class="line">MYSQL_PASSWORD = <span class="hljs-string">'****'</span></span><br><span class="line">MYSQL_DB = <span class="hljs-string">'xiaoshuo'</span></span><br></pre></td></tr></table></figure></p>
<p>在开始写sql.py之前，我们需要安装一个Python操作MySQL的包，来自MySQL官方的一个包：<a href="http://cdn.mysql.com//Downloads/Connector-Python/mysql-connector-python-2.1.4.zip" target="_blank" rel="noopener">点我下载</a></p>
<p>下载完成后解压出来，从 cmd 进入该目录的绝对路径，然后 python setup.py install ；即可完成安装(记得以管理员身份打开命令行)</p>
<p>sql.py<br><figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> mysql.connector</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">from</span> ScrapyDemo <span class="hljs-keyword">import</span> settings</span><br><span class="line"></span><br><span class="line">MYSQL_USER = settings.MYSQL_USER</span><br><span class="line">MYSQL_PASSWORD = settings.MYSQL_PASSWORD</span><br><span class="line">MYSQL_HOST = settings.MYSQL_HOSTS</span><br><span class="line">MYSQL_PORT = settings.MYSQL_PORT</span><br><span class="line">MYSQL_DB = settings.MYSQL_DB</span><br><span class="line"></span><br><span class="line">cnx = mysql.connector.connect(user=MYSQL_USER, password=MYSQL_PASSWORD, host=MYSQL_HOST, database=MYSQL_DB)</span><br><span class="line">cur = cnx.cursor(buffered=<span class="hljs-keyword">True</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Sql</span>:</span></span><br><span class="line"><span class="hljs-meta">    @classmethod</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">insert_dd_name</span><span class="hljs-params">(cls, xs_name, xs_author, category, name_id)</span>:</span></span><br><span class="line">        sql = <span class="hljs-string">'INSERT INTO dd_name (`xs_name`,`xs_author`,`category`,``name_id) VALUES (%(xs_name)s,%(xs_author)s,,%(category)s,,%(name_id)s)'</span></span><br><span class="line">        VALUE = &#123;</span><br><span class="line">            <span class="hljs-string">'xs_name'</span>: xs_name,</span><br><span class="line">            <span class="hljs-string">'xs_author'</span>: xs_author,</span><br><span class="line">            <span class="hljs-string">'category'</span>: category,</span><br><span class="line">            <span class="hljs-string">'name_id'</span>: name_id</span><br><span class="line">        &#125;</span><br><span class="line">        cur.execute(sql, VALUE)</span><br><span class="line">        cnx.commit()</span><br><span class="line"></span><br><span class="line"><span class="hljs-meta">    @classmethod</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">select_name</span><span class="hljs-params">(cls, name_id)</span>:</span></span><br><span class="line">        sql = <span class="hljs-string">'SELECT EXISTS(SELECT 1 FROM dd_name WHERE name_id=%(name_id)s)'</span></span><br><span class="line">        value = &#123;</span><br><span class="line">            <span class="hljs-string">'name_id'</span>: name_id</span><br><span class="line">        &#125;</span><br><span class="line">        cur.execute(sql, value)</span><br><span class="line">        cnx.commit()</span><br></pre></td></tr></table></figure></p>
<p>来开始写pipeline<br><figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">from</span> ScrapyDemo.items <span class="hljs-keyword">import</span> ScrapydemoItem</span><br><span class="line"><span class="hljs-keyword">from</span> .sql <span class="hljs-keyword">import</span> Sql</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ScrapyPipeline</span><span class="hljs-params">(object)</span>:</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">process_item</span><span class="hljs-params">(self, item, sqider)</span>:</span></span><br><span class="line">        <span class="hljs-keyword">if</span> isinstance(item, ScrapydemoItem):</span><br><span class="line">            name_id = item[<span class="hljs-string">'name_id'</span>]</span><br><span class="line">            ret = Sql.select_name(name_id)</span><br><span class="line">            <span class="hljs-keyword">if</span> ret[<span class="hljs-number">0</span>] == <span class="hljs-number">1</span>:</span><br><span class="line">                print(<span class="hljs-string">'已经存在了'</span>)</span><br><span class="line">                <span class="hljs-keyword">pass</span></span><br><span class="line">            <span class="hljs-keyword">else</span>:</span><br><span class="line">                xs_name = item[<span class="hljs-string">'xs_name'</span>]</span><br><span class="line">                xs_author = item[<span class="hljs-string">'xs_author'</span>]</span><br><span class="line">                category = item[<span class="hljs-string">'category'</span>]</span><br><span class="line">                Sql.insert_dd_name(xs_name, xs_author, category, name_id)</span><br><span class="line">                print(<span class="hljs-string">'开始存小说标题'</span>)</span><br></pre></td></tr></table></figure></p>
<p>定义了一个process_item函数并有，item和spider这两个参数（<strong>请注意啊！这两玩意儿 务必！！！要加上！！千万不能少！！！！务必！！！务必！！！</strong>）</p>
<p>搞完！下面我们启用这个Pipeline在settings中作如下设置：</p>
<p><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/12/setting02.png" alt=""></p>
<p>后面的 1 是优先级程度（1-1000随意设置，数值越低，组件的优先级越高）</p>
<p>下面我们开始还剩下的一些内容获取：小说章节 和章节内容</p>
<p>首先我们在 item.py 中新定义一些需要获取内容的字段：</p>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> scrapy</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ScrapydemoItem</span><span class="hljs-params">(scrapy.Item)</span>:</span></span><br><span class="line">    <span class="hljs-comment"># 小说名字</span></span><br><span class="line">    name = scrapy.Field()</span><br><span class="line">    <span class="hljs-comment"># 作者</span></span><br><span class="line">    author = scrapy.Field()</span><br><span class="line">    <span class="hljs-comment"># 小说地址</span></span><br><span class="line">    novelurl = scrapy.Field()</span><br><span class="line">    <span class="hljs-comment"># 连载状态</span></span><br><span class="line">    serialstatus = scrapy.Field()</span><br><span class="line">    <span class="hljs-comment"># 连载字数</span></span><br><span class="line">    serialnumber = scrapy.Field()</span><br><span class="line">    <span class="hljs-comment"># 类别</span></span><br><span class="line">    category = scrapy.Field()</span><br><span class="line">    <span class="hljs-comment"># 编号</span></span><br><span class="line">    novel_id = scrapy.Field()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Content</span><span class="hljs-params">(scrapy.Item)</span>:</span></span><br><span class="line">    id_name = scrapy.Field()</span><br><span class="line">    chaptercontent = scrapy.Field()</span><br><span class="line">    num = scrapy.Field()</span><br><span class="line">    chapter_url = scrapy.Field()</span><br><span class="line">    chapter_name = scrapy.Field()</span><br></pre></td></tr></table></figure>
<p>继续编写Spider文件：</p>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_chapterurl</span><span class="hljs-params">(self, response)</span>:</span></span><br><span class="line">    item = ScrapydemoItem()</span><br><span class="line">    item[<span class="hljs-string">'name'</span>] = str(response.meta[<span class="hljs-string">'name'</span>]).replace(<span class="hljs-string">'\xa0'</span>, <span class="hljs-string">''</span>)</span><br><span class="line">    item[<span class="hljs-string">'novelurl'</span>] = response.meta[<span class="hljs-string">'url'</span>]</span><br><span class="line">    category = BeautifulSoup(response.text, <span class="hljs-string">'lxml'</span>).find(<span class="hljs-string">'table'</span>).find(<span class="hljs-string">'a'</span>).get_text()</span><br><span class="line">    author = BeautifulSoup(response.text, <span class="hljs-string">'lxml'</span>).find(<span class="hljs-string">'table'</span>).find_all(<span class="hljs-string">'td'</span>)[<span class="hljs-number">1</span>].get_text()</span><br><span class="line">    bash_url = BeautifulSoup(response.text, <span class="hljs-string">'lxml'</span>).find(<span class="hljs-string">'p'</span>, class_=<span class="hljs-string">'btnlinks'</span>).find(<span class="hljs-string">'a'</span>, class_=<span class="hljs-string">'read'</span>)[<span class="hljs-string">'href'</span>]</span><br><span class="line">    name_id = str(bash_url)[<span class="hljs-number">-6</span>:<span class="hljs-number">-1</span>].replace(<span class="hljs-string">'/'</span>, <span class="hljs-string">''</span>)</span><br><span class="line">    item[<span class="hljs-string">'category'</span>] = str(category).replace(<span class="hljs-string">'/'</span>, <span class="hljs-string">''</span>)</span><br><span class="line">    item[<span class="hljs-string">'author'</span>] = str(author).replace(<span class="hljs-string">'/'</span>, <span class="hljs-string">''</span>)</span><br><span class="line">    item[<span class="hljs-string">'name_id'</span>] = name_id</span><br><span class="line">    <span class="hljs-keyword">yield</span> item</span><br><span class="line">    <span class="hljs-keyword">yield</span> Request(bash_url, callback=self.get_chapter, meta=&#123;<span class="hljs-string">'name_id'</span>: name_id&#125;)</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_chapter</span><span class="hljs-params">(self, response)</span>:</span></span><br><span class="line">    urls = re.findall(<span class="hljs-string">r'&lt;td class="L"&gt;&lt;a href="(.*?)"&gt;(.*?)&lt;/a&gt;&lt;/td&gt;'</span>, response.text)</span><br><span class="line">    num = <span class="hljs-number">0</span></span><br><span class="line">    <span class="hljs-keyword">for</span> url <span class="hljs-keyword">in</span> urls:</span><br><span class="line">        num = num + <span class="hljs-number">1</span></span><br><span class="line">        chapterurl = response.url + url[<span class="hljs-number">0</span>]</span><br><span class="line">        chaptername = url[<span class="hljs-number">1</span>]</span><br><span class="line">        <span class="hljs-keyword">yield</span> Request(chapterurl, callback=self.get_chaptercontent, meta=&#123;</span><br><span class="line">            <span class="hljs-string">'num'</span>: num,</span><br><span class="line">            <span class="hljs-string">'name_id'</span>: response.meta[<span class="hljs-string">'name_id'</span>],</span><br><span class="line">            <span class="hljs-string">'chapter_url'</span>: chapterurl,</span><br><span class="line">            <span class="hljs-string">'chaptername'</span>: chaptername</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_chaptercontent</span><span class="hljs-params">(self, response)</span>:</span></span><br><span class="line">    item = Content()</span><br><span class="line">    item[<span class="hljs-string">'id_name'</span>] = response.meta[<span class="hljs-string">'name_id'</span>]</span><br><span class="line">    item[<span class="hljs-string">'num'</span>] = response.meta[<span class="hljs-string">'num'</span>]</span><br><span class="line">    item[<span class="hljs-string">'chapter_url'</span>] = response.meta[<span class="hljs-string">'chapter_url'</span>]</span><br><span class="line">    item[<span class="hljs-string">'chapter_name'</span>] = response.meta[<span class="hljs-string">'chaptername'</span>]</span><br><span class="line">    content = BeautifulSoup(response.text, <span class="hljs-string">'lxml'</span>).find(<span class="hljs-string">'dd'</span>, id=<span class="hljs-string">'contents'</span>).get_text()</span><br><span class="line">    item[<span class="hljs-string">'content'</span>] = str(content).replace(<span class="hljs-string">'\xa0'</span>, <span class="hljs-string">''</span>)</span><br><span class="line">    <span class="hljs-keyword">return</span> item</span><br></pre></td></tr></table></figure>
<p>注意 13\14 行，这个地方返回item是不能用return的哦！用了就结束了，程序就不会继续下去了，得用 yield</p>
<p>下面我们来写存储这部分spider的Pipeline：</p>
<p>数据表：<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">IF</span> <span class="hljs-keyword">EXISTS</span> <span class="hljs-string">`dd_chaptername`</span>;</span><br><span class="line"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-string">`dd_chaptername`</span> (</span><br><span class="line">  <span class="hljs-string">`id`</span> <span class="hljs-built_in">int</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="hljs-string">`xs_chaptername`</span> <span class="hljs-built_in">varchar</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">  <span class="hljs-string">`xs_content`</span> <span class="hljs-built_in">text</span>,</span><br><span class="line">  <span class="hljs-string">`id_name`</span> <span class="hljs-built_in">int</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">  <span class="hljs-string">`num_id`</span> <span class="hljs-built_in">int</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">  <span class="hljs-string">`url`</span> <span class="hljs-built_in">varchar</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="hljs-keyword">KEY</span> (<span class="hljs-string">`id`</span>)</span><br><span class="line">) <span class="hljs-keyword">ENGINE</span>=<span class="hljs-keyword">InnoDB</span> AUTO_INCREMENT=<span class="hljs-number">2726</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">CHARSET</span>=gb18030;</span><br><span class="line"><span class="hljs-keyword">SET</span> FOREIGN_KEY_CHECKS=<span class="hljs-number">1</span>;</span><br></pre></td></tr></table></figure></p>
<p><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/12/Scrapy13.png" alt=""><br><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/12/Scrapy14.png" alt=""></p>
<p>下面是Pipeline：</p>
<p><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/12/scrapy21.png" alt=""></p>
<p>有小伙伴注意，这儿比上面一个Pipeline少一个判断，因为我把判断移动到Spider中去了，这样就可以减少一次Request，减轻服务器压力。</p>
<p>改变后的Spider长这样：</p>
<p><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/12/Scrapy16.png" alt=""></p>

        </div>
        
        <div class="level is-size-7 is-uppercase">
            <div class="level-start">
                <div class="level-item">
                    <span class="is-size-6 has-text-grey has-mr-7">#</span>
                    <a class="has-link-grey -link" href="/tags/Python/">Python</a>, <a class="has-link-grey -link" href="/tags/爬虫/">爬虫</a>
                </div>
            </div>
        </div>
        
        
        
    </div>
</div>


<div class="card card-transparent">
    <div class="level post-navigation is-flex-wrap is-mobile">
        
        <div class="level-start">
            <a class="level level-item has-link-grey  article-nav-prev" href="/2017/09/18/四年之久/">
                <i class="level-item material-icons">keyboard_arrow_left</i>
                <span class="level-item">四年之久</span>
            </a>
        </div>
        
        
        <div class="level-end">
            <a class="level level-item has-link-grey  article-nav-next" href="/2017/09/02/妹子图爬虫第四弹/">
                <span class="level-item">妹子图爬虫第四弹</span>
                <i class="level-item material-icons">keyboard_arrow_right</i>
            </a>
        </div>
        
    </div>
</div>



<div class="card">
    <div class="card-content">
        <h3 class="title is-5 has-text-weight-normal">评论</h3>
        
<div id="SOHUCS" sid="2017/09/02/Scrapy-入门/"></div>
<script charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/changyan.js" ></script>
<script type="text/javascript">
window.changyan.api.config({
    appid: 'cytbPTnjI',
    conf: '96c2d0183701bbf3977fba585925c4ff'
});
</script>

    </div>
</div>
</div>
                


<div class="column has-order-1 is-4-tablet is-4-desktop is-3-widescreen ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered">
                <div>
                    <img class="image is-128x128 has-mb-6" src="/images/ha.jpg">
                    
                    <p class="is-size-4 is-block">
                        changoal
                    </p>
                    
                    
                    <p class="is-size-6 is-block">
                        十年之前和现在
                    </p>
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="material-icons is-size-5 has-mr-7">location_on</i>
                        <span>BeiJing</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered">
                <div>
                    <p class="heading">
                        文章
                    </p>
                    <p class="title has-text-weight-normal">
                        72
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered">
                <div>
                    <p class="heading">
                        分类
                    </p>
                    <p class="title has-text-weight-normal">
                        16
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered">
                <div>
                    <p class="heading">
                        标签
                    </p>
                    <p class="title has-text-weight-normal">
                        29
                    </p>
                </div>
            </div>
        </nav>
        <div class="level">
            <a class="level-item button is-link is-rounded" href="http://github.com/changoal">
                关注我</a>
        </div>
        
        
        <div class="level is-mobile">
            
            <a class="level-item button is-white" target="_blank"
                title="Github" href="http://github.com/changoal">
                
                <i class="fab fa-github"></i>
                
            </a>
            
            <a class="level-item button is-white" target="_blank"
                title="Twitter" href="http://twitter.com/Changoall">
                
                <i class="fab fa-twitter"></i>
                
            </a>
            
            <a class="level-item button is-white" target="_blank"
                title="Weibo" href="https://weibo.com/p/1005056712011575">
                
                <i class="fab fa-weibo"></i>
                
            </a>
            
            <a class="level-item button is-white" target="_blank"
                title="Zhihu" href="http://www.zhihu.com/people/changoal">
                
                <i class="fab fa-zhihu"></i>
                
            </a>
            
        </div>
        
    </div>
</div>
    
        
    
        

<div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            链接
        </h3>
        <ul class="menu-list">
        
            <li>
                <a class="level" href="http://blog.kinderriven.cn/" target="_blank">
                    <span class="level-left">
                        <span class="level-item">花月阁</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">http://blog.kinderriven.cn/</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level" href="http://blog.csdn.net/LEE18254290736" target="_blank">
                    <span class="level-left">
                        <span class="level-item">LEE</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">http://blog.csdn.net/LEE18254290736</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level" href="http://gongchen.net.cn/" target="_blank">
                    <span class="level-left">
                        <span class="level-item">宫晨写字的地方</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">http://gongchen.net.cn/</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level" href="http://blog.alrise.xyz/" target="_blank">
                    <span class="level-left">
                        <span class="level-item">求学</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">http://blog.alrise.xyz/</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level" href="http://leoshi.me/" target="_blank">
                    <span class="level-left">
                        <span class="level-item">Leo Shi</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">http://leoshi.me/</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level" href="http://2naive.cn/" target="_blank">
                    <span class="level-left">
                        <span class="level-item">大队长</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">http://2naive.cn/</span>
                    </span>
                </a>
            </li>
        
        </ul>
        </div>
    </div>
</div>


    
        
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                分类
            </h3>
            <ul class="menu-list">
            <li>
        <a class="level is-marginless" href="/categories/Android/">
            <span class="level-start">
                <span class="level-item">Android</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">18</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Java/">
            <span class="level-start">
                <span class="level-item">Java</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Python/">
            <span class="level-start">
                <span class="level-item">Python</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">10</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/Python/Django/">
            <span class="level-start">
                <span class="level-item">Django</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Python/爬虫/">
            <span class="level-start">
                <span class="level-item">爬虫</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">7</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/师太/">
            <span class="level-start">
                <span class="level-item">师太</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/想说的/">
            <span class="level-start">
                <span class="level-item">想说的</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/摄影/">
            <span class="level-start">
                <span class="level-item">摄影</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/数据结构/">
            <span class="level-start">
                <span class="level-item">数据结构</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/文字/">
            <span class="level-start">
                <span class="level-item">文字</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/文字/收藏/">
            <span class="level-start">
                <span class="level-item">收藏</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/生活/">
            <span class="level-start">
                <span class="level-item">生活</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/算法/">
            <span class="level-start">
                <span class="level-item">算法</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/编程思想/">
            <span class="level-start">
                <span class="level-item">编程思想</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/足球/">
            <span class="level-start">
                <span class="level-item">足球</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li>
            </ul>
        </div>
    </div>
</div>
    
        
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            标签云
        </h3>
        <a href="/tags/Android/" style="font-size: 20px;">Android</a> <a href="/tags/Android开发艺术探索/" style="font-size: 11.43px;">Android开发艺术探索</a> <a href="/tags/Django/" style="font-size: 14.29px;">Django</a> <a href="/tags/Java/" style="font-size: 11.43px;">Java</a> <a href="/tags/Lottie/" style="font-size: 10px;">Lottie</a> <a href="/tags/Python/" style="font-size: 18.57px;">Python</a> <a href="/tags/RecyclerView/" style="font-size: 10px;">RecyclerView</a> <a href="/tags/RxJava/" style="font-size: 10px;">RxJava</a> <a href="/tags/Scrapy/" style="font-size: 11.43px;">Scrapy</a> <a href="/tags/bug/" style="font-size: 10px;">bug</a> <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/动态权限申请/" style="font-size: 10px;">动态权限申请</a> <a href="/tags/北漂/" style="font-size: 11.43px;">北漂</a> <a href="/tags/师太/" style="font-size: 12.86px;">师太</a> <a href="/tags/想说的/" style="font-size: 17.14px;">想说的</a> <a href="/tags/感悟/" style="font-size: 10px;">感悟</a> <a href="/tags/排序/" style="font-size: 10px;">排序</a> <a href="/tags/推荐/" style="font-size: 10px;">推荐</a> <a href="/tags/摄影/" style="font-size: 10px;">摄影</a> <a href="/tags/收藏/" style="font-size: 10px;">收藏</a> <a href="/tags/数据结构/" style="font-size: 11.43px;">数据结构</a> <a href="/tags/文字/" style="font-size: 10px;">文字</a> <a href="/tags/杂/" style="font-size: 12.86px;">杂</a> <a href="/tags/爬虫/" style="font-size: 15.71px;">爬虫</a> <a href="/tags/生活/" style="font-size: 11.43px;">生活</a> <a href="/tags/编程思想/" style="font-size: 10px;">编程思想</a> <a href="/tags/足球/" style="font-size: 12.86px;">足球</a> <a href="/tags/随笔/" style="font-size: 10px;">随笔</a> <a href="/tags/面试/" style="font-size: 10px;">面试</a>
    </div>
</div>

    
    
        <div class="card card-transparent is-hidden-widescreen">
        
            
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            最新文章
        </h3>
        
        <article class="media">
            
            <a href="/2018/12/31/2018-end/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="2018 end">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-12-31T12:59:51.000Z">2018-12-31</time></div>
                    <a href="/2018/12/31/2018-end/" class="has-link-black-ter is-size-6">2018 end</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2018/12/26/Android-屏幕适配/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/landscape.jpg" alt="Android 屏幕适配">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-12-26T11:27:44.000Z">2018-12-26</time></div>
                    <a href="/2018/12/26/Android-屏幕适配/" class="has-link-black-ter is-size-6">Android 屏幕适配</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Android/">Android</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2018/12/06/RxJava系列-一-入门/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/landscape.jpg" alt="RxJava系列(一) 入门">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-12-06T14:46:22.000Z">2018-12-06</time></div>
                    <a href="/2018/12/06/RxJava系列-一-入门/" class="has-link-black-ter is-size-6">RxJava系列(一) 入门</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Android/">Android</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2018/12/05/todo/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="todo">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-12-05T08:51:54.000Z">2018-12-05</time></div>
                    <a href="/2018/12/05/todo/" class="has-link-black-ter is-size-6">todo</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2018/09/28/Android流行ORM框架/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/landscape.jpg" alt="Android流行ORM框架">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-09-28T10:46:37.000Z">2018-09-28</time></div>
                    <a href="/2018/09/28/Android流行ORM框架/" class="has-link-black-ter is-size-6">Android流行ORM框架</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Android/">Android</a>
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>

        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                标签
            </h3>
            <ul class="menu-list">
                
                <li>
                    <a class="level is-marginless" href="/tags/Android/">
                        <span class="level-start">
                            <span class="level-item">Android</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">27</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/Android开发艺术探索/">
                        <span class="level-start">
                            <span class="level-item">Android开发艺术探索</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">2</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/Django/">
                        <span class="level-start">
                            <span class="level-item">Django</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">4</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/Java/">
                        <span class="level-start">
                            <span class="level-item">Java</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">2</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/Lottie/">
                        <span class="level-start">
                            <span class="level-item">Lottie</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/Python/">
                        <span class="level-start">
                            <span class="level-item">Python</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">12</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/RecyclerView/">
                        <span class="level-start">
                            <span class="level-item">RecyclerView</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/RxJava/">
                        <span class="level-start">
                            <span class="level-item">RxJava</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/Scrapy/">
                        <span class="level-start">
                            <span class="level-item">Scrapy</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">2</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/bug/">
                        <span class="level-start">
                            <span class="level-item">bug</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/linux/">
                        <span class="level-start">
                            <span class="level-item">linux</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/动态权限申请/">
                        <span class="level-start">
                            <span class="level-item">动态权限申请</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/北漂/">
                        <span class="level-start">
                            <span class="level-item">北漂</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">2</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/师太/">
                        <span class="level-start">
                            <span class="level-item">师太</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">3</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/想说的/">
                        <span class="level-start">
                            <span class="level-item">想说的</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">8</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/感悟/">
                        <span class="level-start">
                            <span class="level-item">感悟</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/排序/">
                        <span class="level-start">
                            <span class="level-item">排序</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/推荐/">
                        <span class="level-start">
                            <span class="level-item">推荐</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/摄影/">
                        <span class="level-start">
                            <span class="level-item">摄影</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/收藏/">
                        <span class="level-start">
                            <span class="level-item">收藏</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/数据结构/">
                        <span class="level-start">
                            <span class="level-item">数据结构</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">2</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/文字/">
                        <span class="level-start">
                            <span class="level-item">文字</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/杂/">
                        <span class="level-start">
                            <span class="level-item">杂</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">3</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/爬虫/">
                        <span class="level-start">
                            <span class="level-item">爬虫</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">7</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/生活/">
                        <span class="level-start">
                            <span class="level-item">生活</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">2</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/编程思想/">
                        <span class="level-start">
                            <span class="level-item">编程思想</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/足球/">
                        <span class="level-start">
                            <span class="level-item">足球</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">3</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/随笔/">
                        <span class="level-start">
                            <span class="level-item">随笔</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/面试/">
                        <span class="level-start">
                            <span class="level-item">面试</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>
        
        </div>
    
</div>

                


<div class="column has-order-3 is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only">
    
        
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            最新文章
        </h3>
        
        <article class="media">
            
            <a href="/2018/12/31/2018-end/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="2018 end">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-12-31T12:59:51.000Z">2018-12-31</time></div>
                    <a href="/2018/12/31/2018-end/" class="has-link-black-ter is-size-6">2018 end</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2018/12/26/Android-屏幕适配/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/landscape.jpg" alt="Android 屏幕适配">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-12-26T11:27:44.000Z">2018-12-26</time></div>
                    <a href="/2018/12/26/Android-屏幕适配/" class="has-link-black-ter is-size-6">Android 屏幕适配</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Android/">Android</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2018/12/06/RxJava系列-一-入门/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/landscape.jpg" alt="RxJava系列(一) 入门">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-12-06T14:46:22.000Z">2018-12-06</time></div>
                    <a href="/2018/12/06/RxJava系列-一-入门/" class="has-link-black-ter is-size-6">RxJava系列(一) 入门</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Android/">Android</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2018/12/05/todo/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="todo">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-12-05T08:51:54.000Z">2018-12-05</time></div>
                    <a href="/2018/12/05/todo/" class="has-link-black-ter is-size-6">todo</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2018/09/28/Android流行ORM框架/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/landscape.jpg" alt="Android流行ORM框架">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-09-28T10:46:37.000Z">2018-09-28</time></div>
                    <a href="/2018/09/28/Android流行ORM框架/" class="has-link-black-ter is-size-6">Android流行ORM框架</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Android/">Android</a>
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>

    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                标签
            </h3>
            <ul class="menu-list">
                
                <li>
                    <a class="level is-marginless" href="/tags/Android/">
                        <span class="level-start">
                            <span class="level-item">Android</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">27</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/Android开发艺术探索/">
                        <span class="level-start">
                            <span class="level-item">Android开发艺术探索</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">2</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/Django/">
                        <span class="level-start">
                            <span class="level-item">Django</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">4</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/Java/">
                        <span class="level-start">
                            <span class="level-item">Java</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">2</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/Lottie/">
                        <span class="level-start">
                            <span class="level-item">Lottie</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/Python/">
                        <span class="level-start">
                            <span class="level-item">Python</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">12</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/RecyclerView/">
                        <span class="level-start">
                            <span class="level-item">RecyclerView</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/RxJava/">
                        <span class="level-start">
                            <span class="level-item">RxJava</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/Scrapy/">
                        <span class="level-start">
                            <span class="level-item">Scrapy</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">2</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/bug/">
                        <span class="level-start">
                            <span class="level-item">bug</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/linux/">
                        <span class="level-start">
                            <span class="level-item">linux</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/动态权限申请/">
                        <span class="level-start">
                            <span class="level-item">动态权限申请</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/北漂/">
                        <span class="level-start">
                            <span class="level-item">北漂</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">2</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/师太/">
                        <span class="level-start">
                            <span class="level-item">师太</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">3</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/想说的/">
                        <span class="level-start">
                            <span class="level-item">想说的</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">8</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/感悟/">
                        <span class="level-start">
                            <span class="level-item">感悟</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/排序/">
                        <span class="level-start">
                            <span class="level-item">排序</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/推荐/">
                        <span class="level-start">
                            <span class="level-item">推荐</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/摄影/">
                        <span class="level-start">
                            <span class="level-item">摄影</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/收藏/">
                        <span class="level-start">
                            <span class="level-item">收藏</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/数据结构/">
                        <span class="level-start">
                            <span class="level-item">数据结构</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">2</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/文字/">
                        <span class="level-start">
                            <span class="level-item">文字</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/杂/">
                        <span class="level-start">
                            <span class="level-item">杂</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">3</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/爬虫/">
                        <span class="level-start">
                            <span class="level-item">爬虫</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">7</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/生活/">
                        <span class="level-start">
                            <span class="level-item">生活</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">2</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/编程思想/">
                        <span class="level-start">
                            <span class="level-item">编程思想</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/足球/">
                        <span class="level-start">
                            <span class="level-item">足球</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">3</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/随笔/">
                        <span class="level-start">
                            <span class="level-item">随笔</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/面试/">
                        <span class="level-start">
                            <span class="level-item">面试</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>
    
    
</div>

            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    <img src="/images/icon_round.png" alt="" height="28">
                
                </a>
                <p class="is-size-7">
                &copy; 2018 chang&nbsp;
                Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a
                        href="http://github.com/ppoffice/hexo-theme-icarus">Icarus</a>
                </p>
            </div>
            <div class="level-end">
            
                <div class="field has-addons is-flex-center-mobile has-mt-5-mobile is-flex-wrap is-flex-middle">
                
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Creative Commons" href="https://creativecommons.org/">
                        
                        <i class="fab fa-creative-commons"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/">
                        
                        <i class="fab fa-creative-commons-by"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Download on GitHub" href="http://github.com/ppoffice/hexo-theme-icarus">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                </p>
                
                </div>
            
            </div>
        </div>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("zh-CN");</script>


    
    
    
    <script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js"></script>
    <script>
        (function ($) {
            $(document).ready(function () {
                if (typeof($.fn.lightGallery) === 'function') {
                    $('.article').lightGallery({ selector: '.gallery-item' });
                }
                if (typeof($.fn.justifiedGallery) === 'function') {
                    $('.justified-gallery').justifiedGallery();
                }
            });
        })(jQuery);
    </script>
    

    
    
    
    <div id="outdated">
        <h6>Your browser is out-of-date!</h6>
        <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update my browser now </a></p>
        <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js"></script>
    <script>
        $(document).ready(function () {
            // plugin function, place inside DOM ready function
            outdatedBrowser({
                bgColor: '#f25648',
                color: '#ffffff',
                lowerThan: 'flex'
            })
        });
    </script>
    

    
    
    
    <script src="https://cdn.jsdelivr.net/npm/animejs@2.2.0/anime.js"></script>
    <script>
    function isIE() {
        var ua = window.navigator.userAgent;
        var msie = ua.indexOf('MSIE ');
        var trident = ua.indexOf('Trident/');
        return (msie > 0 || trident > 0);
    }

    $(document).ready(function () {
        $('body').css('opacity', 1);
        if (!isIE()) {
            ['.main > .column:first-child .card',
            '.main > .column:nth-child(2) .card',
            '.main > .column:last-child .card'].map(function(target) {
                anime({
                    targets: target,
                    scale: [0.8, 1],
                    opacity: [0, 1],
                    duration: 300,
                    easing: 'easeOutSine',
                    delay: function(el, i, l) {
                        return i * 100;
                    }
                })
            });
    
            anime({
                targets: '.navbar-main',
                translateY: [-100, 0],
                opacity: [0, 1],
                duration: 300,
                easing: 'easeOutSine'
            });
        }
    });
    </script>
    

    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script>
    MathJax.Hub.Config({
        "HTML-CSS": {matchFontHeight: false},
        SVG: {matchFontHeight: false},
        CommonHTML: {matchFontHeight: false}
    });
</script>

    
    

<div id="back-to-top" class="is-flex is-flex-center is-hidden-tablet">
    <i class="material-icons">keyboard_arrow_up</i>
    <span class="is-size-7">
        回到顶端</span>
</div>
<script>
    $(document).ready(function () {
        var lastScrollTop = 0;
        $(window).scroll(function (event) {
            var scrollTop = $(this).scrollTop();
            if (scrollTop > lastScrollTop || scrollTop === 0) {
                $('#back-to-top').removeClass('is-active');
            } else {
                $('#back-to-top').addClass('is-active');
            }
            lastScrollTop = scrollTop;
        });
        $('#back-to-top').on('click', function () {
            $('body, html').animate({ scrollTop: 0 }, 400);
        });
    });
</script>


    
    

    
    
    
    

    


<script src="/js/main.js"></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="想要查找什么..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: '文章',
                PAGES: '页面',
                CATEGORIES: '分类',
                TAGS: '标签',
                UNTITLED: '(无标题)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js"></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
</body>
</html>